<div class="venue-game-management-container">
  <div class="content-wrapper">
    <div class="header">
      <h2>Venue & Game Management</h2>
      <div class="header-actions">
        <button mat-raised-button color="primary" (click)="addVenue()">
          <mat-icon>add</mat-icon>
          Add Venue
        </button>
        <button mat-raised-button color="accent" (click)="addGame()">
          <mat-icon>add</mat-icon>
          Add Game
        </button>
      </div>
    </div>

    <div *ngIf="venuesLoading || gamesLoading" class="loading-container">
      <mat-spinner diameter="50"></mat-spinner>
      <p>Loading venues and games...</p>
    </div>

    <div *ngIf="!venuesLoading && !gamesLoading" class="content">
      <mat-tab-group>
        <!-- Venues Tab -->
        <mat-tab label="Venues">
          <div class="tab-content">
            <!-- Search Bar -->
            <div class="search-container">
              <mat-form-field appearance="outline" class="search-field">
                <mat-label>Search venues</mat-label>
                <input matInput 
                       [(ngModel)]="venueSearchTerm" 
                       (input)="onVenueSearchChange($any($event.target).value)"
                       placeholder="Search by venue name or address...">
                <mat-icon matSuffix>search</mat-icon>
              </mat-form-field>
            </div>

            <!-- Venues Table -->
            <div class="table-container">
              <table mat-table [dataSource]="filteredVenues" matSort (matSortChange)="onVenueSortChange($event)" class="venues-table">
                <!-- Name Column -->
                <ng-container matColumnDef="name">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Venue Name</th>
                  <td mat-cell *matCellDef="let venue">{{ venue.name }}</td>
                </ng-container>

                <!-- Address Column -->
                <ng-container matColumnDef="address">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Address</th>
                  <td mat-cell *matCellDef="let venue">{{ venue.address }}</td>
                </ng-container>

                <!-- Actions Column -->
                <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef>Actions</th>
                  <td mat-cell *matCellDef="let venue">
                    <div class="action-buttons">
                      <button mat-icon-button (click)="editVenue(venue)" matTooltip="Edit Venue" color="primary">
                        <mat-icon>edit</mat-icon>
                      </button>
                      <button mat-icon-button (click)="deleteVenue(venue)" matTooltip="Delete Venue" color="warn">
                        <mat-icon>delete</mat-icon>
                      </button>
                    </div>
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="venueColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: venueColumns;"></tr>
              </table>

              <!-- Empty State -->
              <div *ngIf="filteredVenues.length === 0 && venues.length === 0" class="no-data">
                <mat-icon>business</mat-icon>
                <p>No venues found</p>
                <button mat-raised-button color="primary" (click)="addVenue()">
                  Create First Venue
                </button>
              </div>

              <!-- No Search Results -->
              <div *ngIf="filteredVenues.length === 0 && venues.length > 0" class="no-data">
                <mat-icon>search_off</mat-icon>
                <p>No venues match your search</p>
                <button mat-button (click)="venueSearchTerm = ''; onVenueSearchChange('')">
                  Clear Search
                </button>
              </div>
            </div>
          </div>
        </mat-tab>

        <!-- Games Tab -->
        <mat-tab label="Games">
          <div class="tab-content">
            <!-- Search Bar -->
            <div class="search-container">
              <mat-form-field appearance="outline" class="search-field">
                <mat-label>Search games</mat-label>
                <input matInput 
                       [(ngModel)]="gameSearchTerm" 
                       (input)="onGameSearchChange($any($event.target).value)"
                       placeholder="Search by venue, day, or time...">
                <mat-icon matSuffix>search</mat-icon>
              </mat-form-field>
            </div>

            <!-- Games Table -->
            <div class="table-container">
              <table mat-table [dataSource]="filteredGames" matSort (matSortChange)="onGameSortChange($event)" class="games-table">
                <!-- Venue Column -->
                <ng-container matColumnDef="venue">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Venue</th>
                  <td mat-cell *matCellDef="let game">{{ getVenueName(game.location_id) }}</td>
                </ng-container>

                <!-- Day Column -->
                <ng-container matColumnDef="day">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Day</th>
                  <td mat-cell *matCellDef="let game">
                    <span class="day-badge">{{ game.game_day }}</span>
                  </td>
                </ng-container>

                <!-- Time Column -->
                <ng-container matColumnDef="time">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Start Time</th>
                  <td mat-cell *matCellDef="let game">{{ game.start_time }}</td>
                </ng-container>

                <!-- Notes Column -->
                <ng-container matColumnDef="notes">
                  <th mat-header-cell *matHeaderCellDef>Notes</th>
                  <td mat-cell *matCellDef="let game">
                    <span class="notes-text">{{ game.notes || 'No notes' }}</span>
                  </td>
                </ng-container>

                <!-- Actions Column -->
                <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef>Actions</th>
                  <td mat-cell *matCellDef="let game">
                    <div class="action-buttons">
                      <button mat-icon-button (click)="editGame(game)" matTooltip="Edit Game" color="primary">
                        <mat-icon>edit</mat-icon>
                      </button>
                      <button mat-icon-button (click)="deleteGame(game)" matTooltip="Delete Game" color="warn">
                        <mat-icon>delete</mat-icon>
                      </button>
                    </div>
                  </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="gameColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: gameColumns;"></tr>
              </table>

              <!-- Empty State -->
              <div *ngIf="filteredGames.length === 0 && games.length === 0" class="no-data">
                <mat-icon>casino</mat-icon>
                <p>No games found</p>
                <button mat-raised-button color="primary" (click)="addGame()">
                  Create First Game
                </button>
              </div>

              <!-- No Search Results -->
              <div *ngIf="filteredGames.length === 0 && games.length > 0" class="no-data">
                <mat-icon>search_off</mat-icon>
                <p>No games match your search</p>
                <button mat-button (click)="gameSearchTerm = ''; onGameSearchChange('')">
                  Clear Search
                </button>
              </div>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>
</div>